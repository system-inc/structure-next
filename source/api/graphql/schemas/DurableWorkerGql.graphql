schema {
    query: Query
    mutation: Mutation
}

"""
The operator of a field filter
"""
enum ColumnFilterConditionOperator {
    Equal
    GreaterThan
    GreaterThanOrEqual
    In
    IsNotNull
    IsNull
    LessThan
    LessThanOrEqual
    Like
    NotEqual
    NotIn
    NotLike
}

input ColumnFilterInput {
    caseSensitive: Boolean
    column: String!
    operator: ColumnFilterConditionOperator!
    value: JSON!
}

"""
A date-time string at UTC, such as 2007-12-03T10:15:30Z, compliant with the `date-time` format outlined in section 5.6 of the RFC 3339 profile of the ISO 8601 standard for representation of dates and times using the Gregorian calendar.This scalar is serialized to a string in ISO 8601 format and parsed from a string in ISO 8601 format.
"""
scalar DateTimeISO

type DurableWorkerStoredTaskGql {
    rpc: JSON!
}

type DurableWorkerTaskExecutionGql {
    attempt: Float!
    completedAt: DateTimeISO
    createdAt: DateTimeISO!
    elapsedTime: Float
    error: JSONObject
    id: String!
    outcome: String
    result: JSON
    startedAt: DateTimeISO
    state: DurableWorkerTaskState!
    task: DurableWorkerStoredTaskGql
    taskId: String!
    updatedAt: DateTimeISO!
}

"""
The state of the durable worker task execution.
"""
enum DurableWorkerTaskState {
    Canceled
    Failed
    NotStarted
    Retry
    Running
    Success
}

type GqlDurableWorkerAvailableMigration {
    """
    The migration index.
    """
    idx: Float!
    """
    The migration tag/name (e.g., "0001_initial_setup").
    """
    tag: String!
    """
    The timestamp when the migration was created.
    """
    when: Float!
}

type GqlDurableWorkerColumn {
    """
    The default value for the column.
    """
    defaultValue: String
    """
    The column name.
    """
    name: String!
    """
    Whether the column is nullable.
    """
    nullable: Boolean!
    """
    Whether the column is a primary key.
    """
    primaryKey: Boolean!
    """
    The column type.
    """
    type: String!
}

type GqlDurableWorkerDatabaseSizeResult {
    """
    The database size in bytes.
    """
    databaseSize: Float!
}

input GqlDurableWorkerInput {
    """
    The durable object ID. Either durableObjectId or durableObjectName must be provided.
    """
    durableObjectId: String
    """
    The durable object name. Either durableObjectId or durableObjectName must be provided.
    """
    durableObjectName: String
    """
    The namespace of the durable object. If not provided and only one namespace is configured, that namespace will be used as default.
    """
    namespace: String
}

type GqlDurableWorkerMigration {
    """
    The timestamp when the migration was applied.
    """
    createdAt: Float!
    """
    The migration ID.
    """
    id: Float!
    """
    The migration tag/name (e.g., "0001_initial_setup").
    """
    tag: String!
}

type GqlDurableWorkerMigrationsResult {
    """
    The list of migrations that have been applied.
    """
    appliedMigrations: [GqlDurableWorkerMigration!]!
    """
    The list of all available migrations in the system.
    """
    availableMigrations: [GqlDurableWorkerAvailableMigration!]!
}

input GqlDurableWorkerReasonInput {
    """
    The durable object ID. Either durableObjectId or durableObjectName must be provided.
    """
    durableObjectId: String
    """
    The durable object name. Either durableObjectId or durableObjectName must be provided.
    """
    durableObjectName: String
    """
    The namespace of the durable object. If not provided and only one namespace is configured, that namespace will be used as default.
    """
    namespace: String
    reason: String
}

type GqlDurableWorkerSchemaResult {
    """
    The tables in the database schema.
    """
    tables: [GqlDurableWorkerTable!]!
}

type GqlDurableWorkerStatusResult {
    """
    The tasks currently being processed.
    """
    activeTasks: [JSON!]!
    """
    The timestamp of the last task processed.
    """
    lastTaskResult: JSON
    """
    The tasks currently scheduled for future execution.
    """
    scheduledTasks: [JSON!]!
    """
    The current status of the durable worker.
    """
    state: String!
    """
    The tasks currently stored in the durable worker.
    """
    storedTasks: [JSON!]!
    """
    The total number of tasks processed since the worker started.
    """
    totalTasksProcessed: Float!
}

type GqlDurableWorkerTable {
    """
    The columns in the table.
    """
    columns: [GqlDurableWorkerColumn!]!
    """
    The table name.
    """
    name: String!
}

type GqlDurableWorkerTaskHistoryResult {
    """
    The task execution history items.
    """
    items: [DurableWorkerTaskExecutionGql!]!
    pagination: Pagination!
}

input GqlDurableWorkerTaskInput {
    """
    The durable object ID. Either durableObjectId or durableObjectName must be provided.
    """
    durableObjectId: String
    """
    The durable object name. Either durableObjectId or durableObjectName must be provided.
    """
    durableObjectName: String
    """
    The namespace of the durable object. If not provided and only one namespace is configured, that namespace will be used as default.
    """
    namespace: String
    """
    Optional task ID to filter execution history.
    """
    taskId: String
}

"""
The `JSON` scalar type represents JSON values as specified by [ECMA-404](http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-404.pdf).
"""
scalar JSON

"""
The `JSONObject` scalar type represents JSON objects as specified by [ECMA-404](http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-404.pdf).
"""
scalar JSONObject

type Mutation {
    durableWorkerAbortPrivileged(input: GqlDurableWorkerReasonInput!): OperationResult!
    durableWorkerDisposePrivileged(input: GqlDurableWorkerInput!): OperationResult!
    durableWorkerScheduleNextAlarmPrivileged(input: GqlDurableWorkerInput!): OperationResult!
    durableWorkerShutdownPrivileged(input: GqlDurableWorkerReasonInput!): OperationResult!
    durableWorkerSubscribe(input: GqlDurableWorkerTaskInput!): OperationResult!
    durableWorkerUnsubscribe(input: GqlDurableWorkerTaskInput!): OperationResult!
}

type OperationResult {
    success: Boolean!
}

"""
The order direction of a query
"""
enum OrderByDirection {
    Ascending
    Descending
}

input OrderByInput {
    direction: OrderByDirection
    key: String!
}

type Pagination {
    itemIndex: Int!
    itemIndexForNextPage: Int
    itemIndexForPreviousPage: Int
    itemsPerPage: Int!
    itemsTotal: Int!
    page: Int!
    pagesTotal: Int!
}

input PaginationInput {
    filters: [ColumnFilterInput!]
    itemIndex: Int
    itemsPerPage: Int!
    orderBy: [OrderByInput!]
}

type Query {
    durableWorkerDatabaseSizePrivileged(input: GqlDurableWorkerInput!): GqlDurableWorkerDatabaseSizeResult!
    durableWorkerMigrationsPrivileged(input: GqlDurableWorkerInput!): GqlDurableWorkerMigrationsResult!
    durableWorkerNamespacesPrivileged: [String!]!
    durableWorkerSchemaPrivileged(input: GqlDurableWorkerInput!): GqlDurableWorkerSchemaResult!
    durableWorkerStatusPrivileged(input: GqlDurableWorkerInput!): GqlDurableWorkerStatusResult!
    durableWorkerTaskHistoryPrivileged(
        input: GqlDurableWorkerTaskInput!
        pagination: PaginationInput!
    ): GqlDurableWorkerTaskHistoryResult!
}
